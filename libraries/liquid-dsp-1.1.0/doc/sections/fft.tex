% 
% MODULE : fft (fast Fourier transform)
%

\newpage
\section{fft (fast Fourier transform)}
\label{module:fft}
%
The fft module in \liquid\ implements fast discrete Fourier transforms
including forward and reverse DFTs as well as real even/odd transforms.

\subsection{Complex Transforms}
\label{module:fft:dft}
Given a vector of complex time-domain samples
$\vec{x} = \left[x(0),x(1),\ldots,x(N-1)\right]^T$
the $N$-point forward discrete Fourier transform is computed as:
%
\begin{equation}
\label{eqn:fft:dft}
    X(k) = \sum_{i=0}^{N-1}{x(i) e^{-j 2 \pi k i/N}}
\end{equation}
%
Similarly, the inverse (reverse) discrete Fourier transform is:
\begin{equation}
\label{eqn:fft:idft}
    x(n) = \sum_{i=0}^{N-1}{X(i) e^{ j 2 \pi n i/N}}
\end{equation}
%
\liquid\ implements only the basic decimation-in-time FFT algorithm for
radix-2 transforms and the slow DFT method otherwise.
Internal methods requiring FFTs, however, will use the {\tt fftw3}
library \cite{fftw:web} if available.
The presence of {\tt fftw3.h} and {\tt libfftw3} are detected by the
configure script at build time.
If found, \liquid\ will link against {\tt fftw} for better performance
(it is, however, the fastest FFT in the west, you know).
If {\tt fftw} is unavailable, however, \liquid\ will use its own, slower
FFT methods for internal processing.
This eliminates {\tt libfftw} as an external dependency, but takes
advantage of it when available.

An example of the interface for computing complex discrete Fourier
transforms is listed below.
Notice the stark similarity to {\tt libfftw3}'s interface.
%
\input{listings/fft.example.c.tex}
%
\begin{figure}
\centering
\subfigure[FFT input (time series)] {
  \includegraphics[trim = 0mm 0mm 0mm 0mm, clip, width=13cm]{figures.gen/fft_example_time}
}
\subfigure[FFT output (frequency response)] {
  \includegraphics[trim = 0mm 0mm 0mm 0mm, clip, width=13cm]{figures.gen/fft_example_freq}
}
\caption{{\tt fft()} demonstration for a 201-point transform}
\label{fig:module:fft}
\end{figure}
%
An example of a low-pass filter design using the Kaiser window can be
found in Figure~\ref{fig:module:fft}.

\subsection{Real even/odd DFTs}
\label{module:fft:r2r}
%
\liquid\ also implement real even/odd discrete Fourier transforms;
however these are not guaranteed to be efficient.
A list of the transforms and their descriptions is given below.
%
\subsubsection{{\tt FFT\_REDFT00} (DCT-I)}
\label{module:fft:r2r:REDFT00}
    \begin{equation}
    \label{eqn:fft:dct-I}
        X(k) = \frac{1}{2}\Bigl( x(0) + (-1)^k x(N-1) \Bigr) + 
               \sum_{n=1}^{N-2}{x(n) \cos\left(\frac{\pi}{N-1}nk\right) }
    \end{equation}

\subsubsection{{\tt FFT\_REDFT10} (DCT-II)}
\label{module:fft:r2r:REDFT10}
    \begin{equation}
    \label{eqn:fft:dct-II}
        X(k) =  \sum_{n=0}^{N-1}{
                    x(n) \cos\left[
                        \frac{\pi}{N}\left(n + 0.5\right)k
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_REDFT01} (DCT-III)}
\label{module:fft:r2r:REDFT01}
    \begin{equation}
    \label{eqn:fft:dct-III}
        X(k) =  \frac{x(0)}{2} +
                \sum_{n=1}^{N-1}{
                    x(n) \cos\left[
                        \frac{\pi}{N}n\left(k + 0.5\right)
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_REDFT11} (DCT-IV)}
\label{module:fft:r2r:REDFT11}
    \begin{equation}
    \label{eqn:fft:dct-IV}
        X(k) =  \sum_{n=0}^{N-1}{
                    x(n) \cos\left[
                        \frac{\pi}{N}
                        \left(n+0.5\right)
                        \left(k+0.5\right)
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_RODFT00} (DST-I)}
\label{module:fft:r2r:RODFT00}
    \begin{equation}
    \label{eqn:fft:dst-I}
        X(k) =  \sum_{n=0}^{N-1}{
                    x(n) \sin\left[
                        \frac{\pi}{N+1}(n+1)(k+1)
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_RODFT10} (DST-II)}
\label{module:fft:r2r:RODFT10}
    \begin{equation}
    \label{eqn:fft:dst-II}
        X(k) =  \sum_{n=0}^{N-1}{
                    x(n) \sin\left[
                        \frac{\pi}{N}(n+0.5)(k+1)
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_RODFT01} (DST-III)}
\label{module:fft:r2r:RODFT01}
    \begin{equation}
    \label{eqn:fft:dst-III}
        X(k) =  \frac{(-1)^k}{2}x(N-1) + 
                \sum_{n=0}^{N-2}{
                    x(n) \sin\left[
                        \frac{\pi}{N}(n+1)(k+0.5)
                    \right]
                }
    \end{equation}

\subsubsection{{\tt FFT\_RODFT11} (DST-IV)}
\label{module:fft:r2r:RODFT11}
    \begin{equation}
    \label{eqn:fft:dst-IV}
        X(k) =  \sum_{n=0}^{N-1}{
                    x(n) \sin\left[
                        \frac{\pi}{N}(n+0.5)(k+0.5)
                    \right]
                }
    \end{equation}

An example of the interface for computing a discrete cosine transform
of type-III ({\tt FFT\_REDFT01}) is listed below.
%
\input{listings/fft_dct.example.c.tex}

%
%\subsection{{\tt mdct} (modified discrete cosine transform)}
%\label{module:fft:mdct}

